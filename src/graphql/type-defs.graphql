directive @auth(requires: Role = REVIEWER) on FIELD_DEFINITION | OBJECT

enum Role {
  ADMIN
  USER
  REVIEWER
}

type UserDetail {
  _id: ID!
  name: String!
  emailAddress: String!
  shortIds: [ShortUrl!]
  isAdmin: Boolean!
  isVerified: Boolean!
}

type User {
  _id: ID!
  name: String!
  emailAddress: String!
}

type ShortUrlDetail {
  _id: String!
  originalUrl: String!
  shareWith: [User!]
  createdBy: User
}

type ShortUrl {
  shortId: String!
  originalUrl: String!
  shareWith: [ID!]
}

type CreateUserResp {
  user: User!
  tokens: Tokens!
}

type LoginUserResp {
  user: User!
  tokens: Tokens!
}

type Tokens {
  accessToken: String!
  refreshToken: String!
}

type Query {
  me: UserDetail! @auth(requires: USER)
  login(emailAddress: String!, password: String!): LoginUserResp!
  expandUrl(shortId: String!): ShortUrlDetail! @auth
}

type Mutation {
  createUser(name: String!, emailAddress: String!, password: String!): CreateUserResp!
  verifyUser(token: String): User!
  shortenUrl(originalUrl: String!, shareWith: [ID!]): ShortUrl! @auth
  editPrivilege(userId: ID!, isAdmin: Boolean!): UserDetail!
    @auth(requires: ADMIN)
  deleteUser(userId: ID!): String! @auth(requires: USER)
}
